<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ranking Graczy - ACG</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* General Body and Navbar styles */
        body {
            background-color: #222;
            color: #eee;
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-y: auto;
        }

        .navbar {
            background-color: #1a1a1a;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            position: fixed;
            width: 100%;
            top: 0;
            left: 0;
            z-index: 1000;
        }

        .navbar .logo-section {
            display: flex;
            align-items: center;
        }

        .navbar .logo {
            height: 40px;
            margin-right: 10px;
        }

        .navbar .site-name {
            color: #fff;
            font-size: 1.5em;
            font-weight: 600;
        }

        .navbar .nav-links a {
            color: #fff;
            text-decoration: none;
            margin-left: 25px;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .navbar .nav-links a:hover {
            color: #007bff;
        }

        /* Ranking Content and List Styles */
        .ranking-content {
            padding: 100px 20px 40px 20px;
            text-align: center;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .ranking-content h1 {
            color: #007bff;
            margin-bottom: 40px;
            font-size: 2.5em;
        }

        .ranking-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
            max-width: 700px;
            margin: 0 auto;
        }

        .player-rank-item {
            background-color: #333;
            border-radius: 8px;
            padding: 10px 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.95em;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-sizing: border-box;
        }

        .player-rank-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }

        .rank-number {
            font-size: 1.5em;
            font-weight: bold;
            color: #007bff;
            min-width: 40px;
            text-align: right;
            margin-right: 15px;
        }

        .player-info {
            display: flex;
            align-items: center;
            flex-grow: 1;
            gap: 10px;
            text-align: left;
        }

        /* Styl dla ikony rangi */
        .rank-icon {
            width: 40px;
            height: 40px;
            flex-shrink: 0;
            object-fit: contain; /* Upewnia się, że cały obrazek jest widoczny */
        }

        .player-name-and-rank {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            flex-grow: 1;
            min-width: 100px;
        }
        .player-name {
            font-size: 1.1em;
            font-weight: 600;
            color: #eee;
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .player-rank-text {
            font-size: 0.8em;
            color: #bbb;
            white-space: nowrap;
        }
        .player-lp-display { /* Styl dla wyświetlania LP pod rangą */
            font-size: 0.8em;
            color: #7fffd4; /* Kolor LP */
            margin-top: 2px; /* Mały odstęp od tekstu rangi */
            white-space: nowrap;
        }

        .player-stats {
            display: flex; /* Zmienione na flex, aby przycisk był po prawej */
            align-items: center; /* Wyśrodkowanie pionowe */
            justify-content: flex-end; /* Przycisk na prawo */
            min-width: 60px; /* Może być mniejszy, skoro tylko przycisk */
            flex-shrink: 0;
        }
        
        .edit-button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background-color 0.3s ease;
            white-space: nowrap; /* Zapobiega łamaniu się tekstu przycisku */
        }

        .edit-button:hover {
            background-color: #0056b3;
        }

        /* Modal (Pop-up) styles */
        .modal {
            display: none; /* Ukryte domyślnie */
            position: fixed; /* Zawsze na wierzchu */
            z-index: 1001; /* Wyżej niż navbar */
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto; /* Włącz scrollowanie, jeśli treść jest za duża */
            background-color: rgba(0,0,0,0.7); /* Czarne, półprzezroczyste tło */
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #333;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            border-radius: 10px;
            width: 80%;
            max-width: 400px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            color: #eee;
            position: relative; /* Dla pozycjonowania przycisku zamknięcia */
        }

        .modal-content h2 {
            color: #007bff;
            margin-top: 0;
            margin-bottom: 20px;
            text-align: center;
        }

        .modal-content label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .modal-content input[type="text"],
        .modal-content input[type="number"] {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #555;
            border-radius: 5px;
            background-color: #444;
            color: #eee;
            box-sizing: border-box;
        }
        
        /* Styl dla listy rozwijanej rang */
        .modal-content select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #555;
            border-radius: 5px;
            background-color: #444;
            color: #eee;
            box-sizing: border-box;
            -webkit-appearance: none; /* Usuwa domyślny styl strzałki w Chrome/Safari */
            -moz-appearance: none;    /* Usuwa domyślny styl strzałki w Firefox */
            appearance: none;         /* Usuwa domyślny styl strzałki */
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%204%205%22%3E%3Cpath%20fill%3D%22%23eee%22%20d%3D%22M2%200L0%202h4zm0%205L0%203h4z%22%2F%3E%3C%2Fsvg%3E'); /* Niestandardowa strzałka */
            background-repeat: no-repeat;
            background-position: right 0.7em top 50%, 0 0;
            background-size: 0.65em auto, 100%;
        }


        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }

        .modal-buttons .save-button {
            background-color: #28a745;
            color: white;
        }

        .modal-buttons .save-button:hover {
            background-color: #218838;
        }

        .modal-buttons .cancel-button {
            background-color: #dc3545;
            color: white;
        }

        .modal-buttons .cancel-button:hover {
            background-color: #c82333;
        }

        .close-button {
            position: absolute;
            top: 10px;
            right: 15px;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-button:hover,
        .close-button:focus {
            color: #eee;
            text-decoration: none;
            cursor: pointer;
        }

        /* Loading state for ranking */
        #rankingLoadingMessage {
            text-align: center;
            margin-top: 50px;
            font-size: 1.2em;
            color: #aaa;
        }

        /* Responsiveness */
        @media (max-width: 768px) {
            .ranking-list {
                max-width: 100%;
            }
            .player-rank-item {
                flex-wrap: wrap;
                justify-content: flex-start;
                padding: 10px;
            }
            .rank-number {
                margin-right: 10px;
                min-width: unset;
                text-align: left;
                order: 1;
            }
            .player-info {
                flex-grow: unset;
                width: calc(100% - 50px);
                order: 2;
            }
            .player-stats {
                width: calc(100% - 55px); /* Dostosuj szerokość, żeby przycisk był ładnie na linii */
                align-items: flex-end; /* Przycisk na prawo */
                margin-top: 5px;
                margin-left: 55px; /* wyrównanie z info o graczu */
                flex-direction: row; /* Przycisk na prawo w jednym rzędzie */
                justify-content: flex-end; /* Przycisk na prawo */
            }
            .edit-button {
                margin-left: 0; /* Usunięto margines, bo teraz będzie po prawej */
            }
            .player-lp-display { /* Na małych ekranach LP pod rangą też się ładnie ułożą */
                font-size: 0.75em;
            }
        }
        @media (max-width: 480px) {
            .ranking-content h1 {
                font-size: 2em;
            }
            .rank-number {
                font-size: 1.3em;
            }
            .player-name {
                font-size: 1em;
            }
            .player-rank-text {
                font-size: 0.75em;
            }
        }

        /* Footer links */
        .footer-bottom-links {
            background-color: #1a1a1a;
            padding: 15px 20px;
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.5);
            width: 100%;
            margin-top: auto;
        }

        .footer-bottom-links a {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #fff;
            font-size: 0.9em;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .footer-bottom-links a:hover {
            color: #007bff;
        }

        .footer-bottom-links img {
            height: 40px;
            width: 40px;
            border-radius: 50%;
            margin-bottom: 5px;
            border: 2px solid transparent;
            transition: border-color 0.3s ease;
        }

        .footer-bottom-links a:hover img {
            border-color: #007bff;
        }

        /* Main footer */
        footer {
            background-color: #111;
            color: #aaa;
            text-align: center;
            padding: 15px 20px;
            font-size: 0.8em;
        }
    </style>
</head>
<body>
    <header class="navbar">
        <div class="logo-section">
            <img src="logo.png" alt="Logo" class="logo">
            <span class="site-name"></span>
        </div>
        <nav class="nav-links">
            <a href="index.html">STRONA GŁÓWNA</a>
            <a href="historia.html">HISTORIA GIER</a>
            <a href="statystyki.html">STATYSTYKI</a>
            <a href="soloq.html">SOLOQ</a>
            <a href="ranking.html">RANKING</a>
            <a href="dodajmecz.html">DODAJ MECZ</a>
            <a href="login.html" id="loginLogoutLink">Zaloguj/Wyloguj</a>
        </nav>
    </header>

    <main class="ranking-content">
        <h1>Ranking Graczy ACG</h1>
        
        <div id="rankingLoadingMessage">Ładowanie rankingu...</div>
        <div id="players-ranking-container" class="ranking-list" style="display: none;">
            </div>

    </main>

    <footer2 class="footer-bottom-links">
        <a href="https://op.gg/pl/lol/summoners/eune/likht-EUNE" target="_blank">
            <img src="top.png" alt="Ikona 1">
            <span>LIKHT</span>
        </a>
        <a href="https://op.gg/pl/lol/summoners/eune/Weedolas-4WB" target="_blank">
            <img src="jg.png" alt="Ikona 2">
            <span>WEEDOLAS</span>
        </a>
        <a href="https://op.gg/pl/lol/summoners/eune/pizza%20fanboy-EUNE" target="_blank">
            <img src="mid.png" alt="Ikona 3">
            <span>REAP</span>
        </a>
        <a href="https://op.gg/pl/lol/summoners/eune/kohayushi-acg" target="_blank">
            <img src="bot.png" alt="Ikona 4">
            <span>KOHAYUSHI</span>
        </a>
        <a href="strona5.html" target="_blank">
            <img src="sup.png" alt="Ikona 5">
            <span>NONE</span>
        </a>
    </footer2>

    <footer>
        <p>2025 &copy; ACG - AC GDAŃSK</p>
    </footer>

    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeEditModal()">&times;</span>
            <h2>Edytuj Rangę i LP</h2>
            <label for="playerNameModal">Nazwa gracza:</label>
            <input type="text" id="playerNameModal" readonly>

            <label for="playerRankModal">Ranga:</label>
            <select id="playerRankModal">
                <option value="iron">Iron</option>
                <option value="bronze">Bronze</option>
                <option value="silver">Silver</option>
                <option value="gold">Gold</option>
                <option value="platinum">Platinum</option>
                <option value="emerald">Emerald</option>
                <option value="diamond">Diamond</option>
                <option value="master">Master</option>
                <option value="grandmaster">Grandmaster</option>
                <option value="challenger">Challenger</option>
            </select>
            <input type="text" id="playerRankDivisionModal" placeholder="Np. I, II, III, IV lub LP dla Master+, np. 500LP">

            <label for="playerLPModal">LP:</label>
            <input type="number" id="playerLPModal" min="0">

            <div class="modal-buttons">
                <button class="save-button" onclick="saveChanges()">Zapisz</button>
                <button class="cancel-button" onclick="closeEditModal()">Anuluj</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getDatabase, ref, onValue, update } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-database.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // Twoja oryginalna konfiguracja Firebase (skopiowana z dodajmecz.html)
        const firebaseConfig = {
            apiKey: "AIzaSyA4depHuFw3bJ3Uq2gjKeiW5umhjiKnJ40",
            authDomain: "acg-skrimy.firebaseapp.com",
            databaseURL: "https://acg-skrimy-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "acg-skrimy",
            storageBucket: "acg-skrimy.firebaseapp.com",
            messagingSenderId: "78237268518",
            appId: "1:78237268518:web:6b02118d081b4a49b384e7",
            measurementId: "G-6VDFPFX560",
        };

        // Inicjalizacja Firebase z Twoją konfiguracją
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const auth = getAuth(app);

        // Referencja do kolekcji 'playersRanking' w Realtime Database
        // WAŻNE: Upewnij się, że ta ścieżka istnieje i zawiera dane graczy
        const playersRankingRef = ref(db, "playersRanking"); 

        // Admin UID - WAŻNE: UPEWNIJ SIĘ, ŻE TO UID JEST PRAWIDŁOWE DLA TWOJEGO KONTA ADMINISTRATORA W FIREBASE AUTHENTICATION
        const ADMIN_UID = "OOiK1fxmfmZSpsTR05bWfK7a3V23";

        // UI Elements
        const playersRankingContainer = document.getElementById('players-ranking-container');
        const rankingLoadingMessage = document.getElementById('rankingLoadingMessage');
        const loginLogoutLink = document.getElementById('loginLogoutLink');

        // Tablica mapująca nazwy rang do nazw plików obrazków (małe litery, bez podziału na dywizje)
        const rankImageMap = {
            'iron': 'iron.png',
            'bronze': 'bronze.png',
            'silver': 'silver.png',
            'gold': 'gold.png',
            'platinum': 'platinum.png',
            'emerald': 'emerald.png',
            'diamond': 'diamond.png',
            'master': 'master.png',
            'grandmaster': 'grandmaster.png',
            'challenger': 'challenger.png'
        };

        let currentEditedPlayerItem = null; // Przechowuje aktualnie edytowany element gracza
        let currentEditedPlayerKey = null; // Przechowuje klucz Firebase aktualnie edytowanego gracza

        // Zmienna do przechowywania stanu zalogowania admina
        let isAdminLoggedIn = false; 

        // Funkcja do dynamicznego renderowania rankingu
        function renderRanking(playersData) {
            playersRankingContainer.innerHTML = ''; // Wyczyść obecną listę
            let rankCounter = 1;

            // Sortowanie graczy: najpierw po LP (malejąco), potem po rankOrder (rosnąco, dla tych samych LP)
            // Jeśli nie masz rankOrder, możesz użyć po prostu LP.
            // Dla rang Master+, Grandmaster, Challenger LP są kluczowe.
            // Dla Diamond, Emerald itd. sortowanie może być po prostu alfabetyczne nazwy rangi i dywizji.
            // Poniższe sortowanie zakłada, że dla Master+ lp są liczbowe, a dla innych rang `rankDivision` to string (I, II, III, IV).
            // Możesz dostosować logikę sortowania do swoich preferencji.
            const sortedPlayers = Object.values(playersData).sort((a, b) => {
                // Konwersja LP na liczbę, jeśli to string "1000LP" -> 1000
                const lpA = typeof a.lp === 'string' ? parseInt(a.lp.replace('LP', '')) : a.lp;
                const lpB = typeof b.lp === 'string' ? parseInt(b.lp.replace('LP', '')) : b.lp;

                if (lpA !== lpB) {
                    return lpB - lpA; // Sortuj malejąco po LP
                }

                // Dla tych samych LP, sortuj po rankOrder (jeśli istnieje)
                if (a.rankOrder && b.rankOrder) {
                    return a.rankOrder - b.rankOrder;
                }
                
                // Jeśli LP są takie same i brak rankOrder, sortuj alfabetycznie po nazwie gracza
                return a.name.localeCompare(b.name);
            });


            sortedPlayers.forEach(player => {
                const playerId = player.name; // Używamy nazwy gracza jako ID (lub możesz użyć klucza Firebase)
                const rankIconSrc = `Images/${rankImageMap[player.rankName.toLowerCase()] || 'default.png'}`; // Użyj default.png jeśli brak
                
                // Zbuduj pełny tekst rangi
                let fullRankText = player.rankName;
                if (player.rankDivision) {
                    fullRankText += ` ${player.rankDivision}`;
                }

                const playerRankItem = document.createElement('div');
                playerRankItem.className = 'player-rank-item';
                playerRankItem.dataset.playerId = playerId;
                // Tutaj zapiszemy klucz Firebase dla gracza, aby móc go aktualizować
                playerRankItem.dataset.firebaseKey = player.key; 

                playerRankItem.innerHTML = `
                    <div class="rank-number">${rankCounter}.</div>
                    <div class="player-info">
                        <img src="${rankIconSrc}" alt="Ikona Rangi ${player.rankName}" class="rank-icon">
                        <div class="player-name-and-rank">
                            <span class="player-name">${player.name}</span>
                            <span class="player-rank-text" data-rank-text>${fullRankText}</span>
                            <span class="player-lp-display" data-lp-text>LP: ${player.lp}</span> 
                        </div>
                    </div>
                    <div class="player-stats">
                        <button class="edit-button" onclick="openEditModal(this)">Edytuj</button>
                    </div>
                `;
                playersRankingContainer.appendChild(playerRankItem);
                rankCounter++;
            });

            // Ukryj przyciski edycji, jeśli użytkownik nie jest adminem
            if (!isAdminLoggedIn) {
                document.querySelectorAll('.edit-button').forEach(button => {
                    button.style.display = 'none';
                });
            } else {
                 document.querySelectorAll('.edit-button').forEach(button => {
                    button.style.display = 'inline-block'; // Pokaż, jeśli admin zalogowany
                });
            }

            rankingLoadingMessage.style.display = 'none'; // Ukryj komunikat ładowania
            playersRankingContainer.style.display = 'flex'; // Pokaż kontener rankingu
        }

        // Authentication State Listener
        onAuthStateChanged(auth, (user) => {
            if (user && user.uid === ADMIN_UID) {
                console.log("Admin zalogowany.");
                isAdminLoggedIn = true;
                loginLogoutLink.textContent = 'Wyloguj';
                loginLogoutLink.href = '#';
                loginLogoutLink.onclick = (e) => {
                    e.preventDefault();
                    signOut(auth).then(() => {
                        alert("Wylogowano pomyślnie.");
                        window.location.reload(); // Odśwież stronę po wylogowaniu
                    }).catch((error) => {
                        console.error("Błąd wylogowania:", error);
                        alert(`Wystąpił błąd podczas wylogowywania: ${error.message}`);
                    });
                };
            } else {
                console.log("Użytkownik niezalogowany lub nie jest adminem.");
                isAdminLoggedIn = false;
                loginLogoutLink.textContent = 'Zaloguj';
                loginLogoutLink.href = 'login.html';
                loginLogoutLink.onclick = null; // Usuń handler, jeśli ma prowadzić do login.html
            }
            // Po ustawieniu stanu admina, pobierz i wyrenderuj ranking
            // Spowoduje to również prawidłowe ukrycie/pokazanie przycisków edycji
            fetchAndRenderRanking(); 
        });


        // Funkcja do pobierania danych z Firebase i renderowania
        function fetchAndRenderRanking() {
            onValue(playersRankingRef, (snapshot) => {
                const playersData = snapshot.val();
                if (playersData) {
                    // Dodaj klucz Firebase do każdego obiektu gracza
                    const playersWithKeys = Object.keys(playersData).map(key => ({
                        key: key,
                        ...playersData[key]
                    }));
                    renderRanking(playersWithKeys);
                } else {
                    playersRankingContainer.innerHTML = '<p>Brak danych rankingu do wyświetlenia.</p>';
                    rankingLoadingMessage.style.display = 'none';
                    playersRankingContainer.style.display = 'flex';
                }
            }, (error) => {
                console.error("Błąd pobierania danych rankingu z Firebase:", error);
                rankingLoadingMessage.textContent = 'Błąd ładowania rankingu.';
            });
        }


        // MODAL FUNCTIONS
        function openEditModal(buttonElement) {
            if (!isAdminLoggedIn) {
                alert("Brak uprawnień do edycji rankingu. Zaloguj się jako administrator.");
                return;
            }

            currentEditedPlayerItem = buttonElement.closest('.player-rank-item');
            currentEditedPlayerKey = currentEditedPlayerItem.dataset.firebaseKey; // Pobierz klucz Firebase

            const playerName = currentEditedPlayerItem.querySelector('.player-name').textContent;
            const rankTextElement = currentEditedPlayerItem.querySelector('[data-rank-text]');
            const lpDisplayElement = currentEditedPlayerItem.querySelector('[data-lp-text]');

            const currentLP = parseInt(lpDisplayElement.textContent.replace('LP: ', '')) || 0;
            const currentRankText = rankTextElement.textContent;

            let currentRankName = '';
            let currentRankDivision = '';
            
            const match = currentRankText.match(/^([a-zA-Z]+)(?:\s([IVXLCDM]+|\d+LP))?$/);

            if (match) {
                currentRankName = match[1].toLowerCase();
                if (match[2]) {
                    currentRankDivision = match[2];
                }
            }

            document.getElementById('playerNameModal').value = playerName;
            document.getElementById('playerLPModal').value = currentLP;
            document.getElementById('playerRankModal').value = currentRankName;
            document.getElementById('playerRankDivisionModal').value = currentRankDivision;

            document.getElementById('editModal').style.display = 'flex';
        }

        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            currentEditedPlayerItem = null;
            currentEditedPlayerKey = null;
        }

        async function saveChanges() {
            if (!currentEditedPlayerItem || !currentEditedPlayerKey) return;
            
            if (!isAdminLoggedIn) { // Dodatkowe zabezpieczenie po stronie klienta
                alert("Brak uprawnień do edycji rankingu.");
                closeEditModal();
                return;
            }

            const newLP = parseInt(document.getElementById('playerLPModal').value);
            const newRankName = document.getElementById('playerRankModal').value;
            const newRankDivision = document.getElementById('playerRankDivisionModal').value.trim();

            const updates = {};
            updates[`/${currentEditedPlayerKey}/lp`] = newLP;
            updates[`/${currentEditedPlayerKey}/rankName`] = newRankName;
            updates[`/${currentEditedPlayerKey}/rankDivision`] = newRankDivision;

            // Opcjonalnie, jeśli masz pole `rankOrder` w bazie danych, możesz je zaktualizować na podstawie LP
            // lub ustalić inną logikę.
            // updates[`/${currentEditedPlayerKey}/rankOrder`] = calculateRankOrder(newRankName, newLP); // Przykładowa funkcja

            try {
                await update(playersRankingRef, updates); // Użyj update na playersRankingRef
                alert("Zmiany zapisane pomyślnie w Firebase!");
                closeEditModal();
            } catch (error) {
                console.error("Błąd zapisu zmian do Firebase:", error);
                alert("Wystąpił błąd podczas zapisu zmian: " + error.message);
            }
        }


        // Zamykanie modala po kliknięciu poza nim
        window.onclick = function(event) {
            const modal = document.getElementById('editModal');
            if (event.target == modal) {
                closeEditModal();
            }
        }

        // Upewnij się, że funkcje openEditModal, closeEditModal, saveChanges są dostępne globalnie
        // dla atrybutów onclick w HTML
        window.openEditModal = openEditModal;
        window.closeEditModal = closeEditModal;
        window.saveChanges = saveChanges;
        
    </script>

</body>
</html>
